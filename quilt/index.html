<html><script>
class DriverClient{constructor(e,t,n,r=!1){if(this.reqs=[],this.reps=[],this.requestId=this.getRequestId(),this.debug=r,e||t||n){let r=new InitMessage(e,t,n);this.openWebsocket(!0,r)}else this.openWebsocket(!1)}sendMessage(e,t,n=60){let r=e.toCbor();this.sendRequestObj(r,t,n)}disconnect(){this.ws.close()}openWebsocket(e,t=""){this.ws=new WebSocket("ws://localhost:11222/driver",["rep.sp.nanomsg.org"]),this.ws.parent=this,this.ws.binaryType="arraybuffer",this.ws.onmessage=this.messageHandler,this.ws.onopen=(()=>{e&&this.sendMessage(t)}),this.ws.onerror=this.errorHandler,this.ws.onclose=(()=>{})}sendRequestObj(e,t,n){let r={id:this.requestId++,parent:this,payload:e,callback:t,send:function(){this.timeout=setTimeout(r.send.bind(this),1e3*n);let t=new Uint8Array(e.byteLength+4);new DataView(t.buffer).setUint32(0,this.id),t.set(new Uint8Array(this.payload),4),this.parent.ws.send(t.buffer)}};this.reqs.push(r),r.send()}messageHandler(e){let t=e.data;if(t.byteLength<4)return;let n=new DataView(t).getUint32(0);if(n<2147483648)return;let r=this.parent.findReqIndex(n);if(-1==r)return;"function"==typeof this.parent.reqs[r].callback&&this.parent.reqs[r].callback(CBOR.decode(i.payload)),clearTimeout(this.parent.reqs[r].timeout),this.parent.reqs.splice(r,1);let i={id:n,payload:t.slice(4)};this.parent.reps.push(i)}getRequestId(){return Math.floor(2147483647*this.prng())+2147483648}errorHandler(e){}err(e){}findReqIndex(e){let t=0;for(;t<this.reqs.length;t++)if(this.reqs[t].id==e)return t;return-1}prng(){return null==this.rng&&(this.rng=generateRng()),this.rng()}}class Message{constructor(){this.cmd={},this.bindata=""}toCbor(){let e={cmd:this.cmd,bin:this.bindata};return CBOR.encode(e)}}class InitMessage extends Message{constructor(e="",t=!1,n="hide"){super(),this.cmd={init:{}},this.cmd.init.appid=e,this.cmd.init.onclose=n,this.cmd.init.greedy=t}}class ShowMessage extends Message{constructor(e=5,t=9,n=45,r=1.6,i=""){super(),this.cmd={show:{targetDisplay:0,source:"bindata",quilt:{type:"image",settings:{vx:e,vy:t,vtotal:n,aspect:r}}}},this.bindata=i}setBindata(e){this.bindata=e}}function generateRng(){var e,t,n,r,i=function(e){for(var t=0,n=1779033703^e.length;t<e.length;t++)n=(n=Math.imul(n^e.charCodeAt(t),3432918353))<<13|n>>>19;return function(){return n=Math.imul(n^n>>>16,2246822507),n=Math.imul(n^n>>>13,3266489909),(n^=n>>>16)>>>0}}(Date.now().toString());return e=i(),t=i(),n=i(),r=i(),()=>{var i=t<<9,s=5*e;return r^=t,t^=n^=e,e^=r,n^=i,r=r<<11|r>>>21,((s=9*(s<<7|s>>>25))>>>0)/4294967296}}var client;function loadExampleQuilt(e,t,n){var r=new XMLHttpRequest;r.responseType="arraybuffer",r.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var r=new ShowMessage(t,n,t*n);r.setBindata(new Uint8Array(this.response)),client.sendMessage(r,function(e){window.location.href=e}(e),10)}},r.open("GET",e,!0),r.send()}!function(e,t){"use strict";var n=Math.pow(2,-24),r=Math.pow(2,32),i=Math.pow(2,53),s={encode:function(e){function n(e){for(var t=h.byteLength,n=d+e;n>t;)t*=2;if(t!==h.byteLength){var r=l;h=new ArrayBuffer(t),l=new DataView(h);for(var i=d+3>>2,s=0;i>s;++s)l.setUint32(4*s,r.getUint32(4*s))}return f=e,l}function s(){d+=f}function a(e){s(n(8).setFloat64(d,e))}function u(e){s(n(1).setUint8(d,e))}function o(e){for(var t=n(e.length),r=0;r<e.length;++r)t.setUint8(d+r,e[r]);s()}function c(e,t){24>t?u(e<<5|t):256>t?(u(e<<5|24),u(t)):65536>t?(u(e<<5|25),function(e){s(n(2).setUint16(d,e))}(t)):4294967296>t?(u(e<<5|26),function(e){s(n(4).setUint32(d,e))}(t)):(u(e<<5|27),function(e){var t=e%r,i=(e-t)/r,a=n(8);a.setUint32(d,i),a.setUint32(d+4,t),s()}(t))}var f,h=new ArrayBuffer(256),l=new DataView(h),d=0;if(function e(n){var r;if(!1===n)return u(244);if(!0===n)return u(245);if(null===n)return u(246);if(n===t)return u(247);switch(typeof n){case"number":if(Math.floor(n)===n){if(n>=0&&i>=n)return c(0,n);if(n>=-i&&0>n)return c(1,-(n+1))}return u(251),a(n);case"string":var s=[];for(r=0;r<n.length;++r){var f=n.charCodeAt(r);128>f?s.push(f):2048>f?(s.push(192|f>>6),s.push(128|63&f)):55296>f?(s.push(224|f>>12),s.push(128|f>>6&63),s.push(128|63&f)):(f=(1023&f)<<10,f|=1023&n.charCodeAt(++r),f+=65536,s.push(240|f>>18),s.push(128|f>>12&63),s.push(128|f>>6&63),s.push(128|63&f))}return c(3,s.length),o(s);default:var h;if(Array.isArray(n))for(c(4,h=n.length),r=0;h>r;++r)e(n[r]);else if(n instanceof Uint8Array)c(2,n.length),o(n);else{var l=Object.keys(n);for(c(5,h=l.length),r=0;h>r;++r){var d=l[r];e(d),e(n[d])}}}}(e),"slice"in h)return h.slice(0,d);for(var g=new ArrayBuffer(d),p=new DataView(g),w=0;d>w;++w)p.setUint8(w,l.getUint8(w));return g},decode:function(e,i,s){function a(e,t){return b+=t,e}function u(t){return a(new Uint8Array(e,b,t),t)}function o(){var e=new ArrayBuffer(4),t=new DataView(e),r=l(),i=32768&r,s=31744&r,a=1023&r;if(31744===s)s=261120;else if(0!==s)s+=114688;else if(0!==a)return a*n;return t.setUint32(0,i<<16|s<<13|a<<13),t.getFloat32(0)}function c(){return a(y.getFloat32(b),4)}function f(){return a(y.getFloat64(b),8)}function h(){return a(y.getUint8(b),1)}function l(){return a(y.getUint16(b),2)}function d(){return a(y.getUint32(b),4)}function g(){return 255===y.getUint8(b)&&(b+=1,!0)}function p(e){if(24>e)return e;if(24===e)return h();if(25===e)return l();if(26===e)return d();if(27===e)return d()*r+d();if(31===e)return-1;throw"Invalid length encoding"}function w(e){var t=h();if(255===t)return-1;var n=p(31&t);if(0>n||t>>5!==e)throw"Invalid indefinite length element";return n}function v(e,t){for(var n=0;t>n;++n){var r=h();128&r&&(224>r?(r=(31&r)<<6|63&h(),t-=1):240>r?(r=(15&r)<<12|(63&h())<<6|63&h(),t-=2):(r=(15&r)<<18|(63&h())<<12|(63&h())<<6|63&h(),t-=3)),65536>r?e.push(r):(r-=65536,e.push(55296|r>>10),e.push(56320|1023&r))}}var y=new DataView(e),b=0;"function"!=typeof i&&(i=function(e){return e}),"function"!=typeof s&&(s=function(){return t});var m=function e(){var n,r,a=h(),l=a>>5,d=31&a;if(7===l)switch(d){case 25:return o();case 26:return c();case 27:return f()}if(0>(r=p(d))&&(2>l||l>6))throw"Invalid length";switch(l){case 0:return r;case 1:return-1-r;case 2:if(0>r){for(var y=[],b=0;(r=w(l))>=0;)b+=r,y.push(u(r));var m=new Uint8Array(b),U=0;for(n=0;n<y.length;++n)m.set(y[n],U),U+=y[n].length;return m}return u(r);case 3:var q=[];if(0>r)for(;(r=w(l))>=0;)v(q,r);else v(q,r);return String.fromCharCode.apply(null,q);case 4:var M;if(0>r)for(M=[];!g();)M.push(e());else for(M=new Array(r),n=0;r>n;++n)M[n]=e();return M;case 5:var A={};for(n=0;r>n||0>r&&!g();++n)A[e()]=e();return A;case 6:return i(e(),r);case 7:switch(r){case 20:return!1;case 21:return!0;case 22:return null;case 23:return t;default:return s(r)}}}();if(b!==e.byteLength)throw"Remaining bytes";return m}};"function"==typeof define&&define.amd?define("cbor/cbor",s):e.CBOR||(e.CBOR=s)}(this),function(){client=new DriverClient("a",!1,"none",!1);var e=new URLSearchParams(window.location.search);e.has("quilt")&&loadExampleQuilt(e.get("quilt"),e.get("vx"),e.get("vy"))}();
</script></html>